(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     38847,       1074]
NotebookOptionsPosition[     37405,       1040]
NotebookOutlinePosition[     37867,       1057]
CellTagsIndexPosition[     37824,       1054]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generate Functions", "Section",
 CellChangeTimes->{{3.824299774076337*^9, 
  3.824299779886828*^9}},ExpressionUUID->"7361888e-6ca7-43b5-b428-\
e323aba84ced"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normv", "[", "x_List", "]"}], " ", ":=", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"x", ".", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normvector", "[", "x_List", "]"}], " ", ":=", " ", 
  RowBox[{"x", "/", 
   RowBox[{"Normv", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rab", "[", 
   RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"position", "[", 
    RowBox[{"[", "a", "]"}], "]"}], " ", "-", " ", 
   RowBox[{"position", "[", 
    RowBox[{"[", "b", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normvsq", "[", "x_List", "]"}], " ", ":=", " ", 
  RowBox[{"x", ".", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhat", "[", 
   RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{"Normvector", "[", 
   RowBox[{"rab", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhatx", "[", 
   RowBox[{"a_Integer", ",", "b_Integer", ",", "i_Integer"}], "]"}], " ", ":=",
   " ", 
  RowBox[{
   RowBox[{"nhat", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "[", 
   RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdot", "[", 
   RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"xdot", "[", 
    RowBox[{"[", "a", "]"}], "]"}], " ", "-", " ", 
   RowBox[{"xdot", "[", 
    RowBox[{"[", "b", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", 
  RowBox[{"Normv", "[", 
   RowBox[{"rab", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psq", "[", "a_Integer", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"[", "a", "]"}], "]"}], ".", 
   RowBox[{"p", "[", 
    RowBox[{"[", "a", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mline", "[", "a_Integer", "]"}], ":=", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"m", "[", 
      RowBox[{"[", "a", "]"}], "]"}], "2"], "+", 
    RowBox[{"psq", "[", "a", "]"}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"mline", "[", "a", "]"}], 
    RowBox[{"-", "1"}]], 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"m", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nhat", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ".", 
        RowBox[{"p", "[", 
         RowBox[{"[", "a", "]"}], "]"}]}], ")"}], 
      "2"]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createPM1", "[", 
   RowBox[{"ndim_", ",", "nbody_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"W", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"position", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "nbody"}], ",", "\[IndentingNewLine]", "PM1", ",", 
      "\[IndentingNewLine]", "newtonH", ",", "\[IndentingNewLine]", "pdot0", 
      ",", "\[IndentingNewLine]", "pdotnewton", ",", "\[IndentingNewLine]", 
      "qdot0", ",", "\[IndentingNewLine]", "qdotnewton", ",", 
      "\[IndentingNewLine]", "equations"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Initialize", " ", "arrays", " ", "and", " ", "important", " ", 
      "functions"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ndim", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"position", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<qx\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<qy\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<qz\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"p", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<px\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<py\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<pz\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"m", ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<m\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"position", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<qx\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<qy\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"p", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<px\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<py\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"m", ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<m\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Normv", "[", "x_List", "]"}], " ", ":=", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"x", ".", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Normvector", "[", "x_List", "]"}], " ", ":=", " ", 
      RowBox[{"x", "/", 
       RowBox[{"Normv", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rab", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"position", "[", 
        RowBox[{"[", "a", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"position", "[", 
        RowBox[{"[", "b", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Normvsq", "[", "x_List", "]"}], " ", ":=", " ", 
      RowBox[{"x", ".", "x"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nhat", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", " ", 
      RowBox[{"Normvector", "[", 
       RowBox[{"rab", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nhatx", "[", 
       RowBox[{"a_Integer", ",", "b_Integer", ",", "i_Integer"}], "]"}], " ", 
      ":=", " ", 
      RowBox[{
       RowBox[{"nhat", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], " ", ":=", 
      RowBox[{"Normv", "[", 
       RowBox[{"rab", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"psq", "[", "a_Integer", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "a", "]"}], "]"}], ".", 
       RowBox[{"p", "[", 
        RowBox[{"[", "a", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mline", "[", "a_Integer", "]"}], ":=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"m", "[", 
          RowBox[{"[", "a", "]"}], "]"}], "2"], "+", 
        RowBox[{"psq", "[", "a", "]"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"a_Integer", ",", "b_Integer"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"mline", "[", "a", "]"}], 
        RowBox[{"-", "1"}]], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"m", "[", 
           RowBox[{"[", "a", "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"nhat", "[", 
             RowBox[{"a", ",", "b"}], "]"}], ".", 
            RowBox[{"p", "[", 
             RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "2"]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Generate", " ", "Hamiltonian", " ", "in", " ", "PM", " ", "1", "st", 
       " ", "order"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"mline", "[", "a", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "G", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "a"}], ",", "0", ",", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"mline", "[", "a", "]"}], 
              RowBox[{"mline", "[", "b", "]"}]}], 
             RowBox[{"R", "[", 
              RowBox[{"a", ",", "b"}], "]"}]], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{"psq", "[", "a", "]"}], 
               SuperscriptBox[
                RowBox[{"mline", "[", "a", "]"}], "2"]], "+", 
              FractionBox[
               RowBox[{"psq", "[", "b", "]"}], 
               SuperscriptBox[
                RowBox[{"mline", "[", "b", "]"}], "2"]]}], ")"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1", ",", "nbody"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      RowBox[{
       FractionBox["1", "4"], "G", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "a"}], ",", "0", ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"R", "[", 
              RowBox[{"a", ",", "b"}], "]"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"7", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], ".", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "b", "]"}], "]"}]}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], ".", 
                 RowBox[{"nhat", "[", 
                  RowBox[{"a", ",", "b"}], "]"}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], ".", 
                 RowBox[{"nhat", "[", 
                  RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1", ",", "nbody"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], "G", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"b", "\[Equal]", "a"}], ",", "0", ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"R", "[", 
              RowBox[{"a", ",", "b"}], "]"}]], 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"mline", "[", "a", "]"}], 
                RowBox[{"mline", "[", "b", "]"}]}], ")"}], 
              RowBox[{"-", "1"}]], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"b", ",", "a"}], "]"}], "+", "1"}], ")"}], "2"], 
              RowBox[{"y", "[", 
               RowBox[{"b", ",", "a"}], "]"}]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"]}], "-", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}], 
                  RowBox[{"psq", "[", "b", "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"psq", "[", "b", "]"}], "2"]}], "-", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}], "2"], 
                  RowBox[{"psq", "[", "b", "]"}]}]}], ")"}], 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"mline", "[", "b", "]"}], "2"]]}], "+", 
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"psq", "[", "a", "]"}]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}]}], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}], "2"], "-", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"], 
                  RowBox[{"psq", "[", "b", "]"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"psq", "[", "a", "]"}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"]}], "+", 
                 RowBox[{"8", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"psq", "[", "a", "]"}], 
                  RowBox[{"psq", "[", "b", "]"}]}], "-", 
                 RowBox[{"3", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ".", 
                    RowBox[{"nhat", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ")"}], "2"], 
                  RowBox[{"psq", "[", "b", "]"}]}]}], ")"}], 
               RowBox[{"y", "[", 
                RowBox[{"b", ",", "a"}], "]"}]}]}], ")"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1", ",", "nbody"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PM1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{"[", "a", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newtonH", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"psq", "[", "a", "]"}], 
           RowBox[{"m", "[", 
            RowBox[{"[", "a", "]"}], "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}], "-", 
       RowBox[{
        FractionBox["G", "2"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"b", "\[Equal]", "a"}], ",", "0", ",", 
            FractionBox[
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", "a", "]"}], "]"}], 
              RowBox[{"m", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], 
             RowBox[{"R", "[", 
              RowBox[{"a", ",", "b"}], "]"}]]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", "nbody"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", "nbody"}], "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Take", " ", "derivatives", " ", "to", " ", "get", " ", "equations", 
       " ", "of", " ", "motion"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pdot0", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"-", "PM1"}], ",", 
          RowBox[{
           RowBox[{"position", "[", 
            RowBox[{"[", "ibody", "]"}], "]"}], "[", 
           RowBox[{"[", "idims", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ibody", ",", "1", ",", "nbody"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"idims", ",", "1", ",", "ndim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qdot0", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"PM1", ",", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "ibody", "]"}], "]"}], "[", 
           RowBox[{"[", "idims", "]"}], "]"}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ibody", ",", "1", ",", "nbody"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"idims", ",", "1", ",", "ndim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pdotnewton", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"-", "newtonH"}], ",", 
          RowBox[{
           RowBox[{"position", "[", 
            RowBox[{"[", "ibody", "]"}], "]"}], "[", 
           RowBox[{"[", "idims", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ibody", ",", "1", ",", "nbody"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"idims", ",", "1", ",", "ndim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qdotnewton", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"newtonH", ",", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "ibody", "]"}], "]"}], "[", 
           RowBox[{"[", "idims", "]"}], "]"}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ibody", ",", "1", ",", "nbody"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"idims", ",", "1", ",", "ndim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"PM1", ",", "qdot0", ",", "pdot0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"newtonH", ",", "qdotnewton", ",", "pdotnewton"}], "}"}]}], 
       "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Format1.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Optimize.m"}]}], "Input",
 CellChangeTimes->{{3.82429958306881*^9, 3.824299598618896*^9}, {
  3.824299673281458*^9, 3.824299727688727*^9}, {3.835968036166656*^9, 
  3.835968047482211*^9}, {3.835968133280403*^9, 3.835968136784849*^9}, {
  3.84053099638673*^9, 3.840530996809778*^9}, {3.840531031086198*^9, 
  3.840531060279972*^9}, {3.840531142644309*^9, 3.840531150749271*^9}, {
  3.8405312788552628`*^9, 3.840531332065805*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"d47d1a9a-d987-449f-8141-2de1b6b60ac4"],

Cell[BoxData["\<\"/Users/zackarywindham/Research/Post-Minkowski/julia_code/\
FormattedEquations/src\"\>"], "Output",
 CellChangeTimes->{{3.840531134990514*^9, 3.8405311514499197`*^9}, 
   3.8405312571508427`*^9, 3.840531307555347*^9, 3.840531359676258*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"5ac70fc3-4892-4f4d-9e5c-285a4f773cd1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Code", "Section",
 CellChangeTimes->{{3.824299793516053*^9, 
  3.824299794996169*^9}},ExpressionUUID->"dde770ff-4d6f-4387-9558-\
a567e7e2526a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"numdim", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "dimensions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "bodies"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndata", "=", 
   RowBox[{"{", 
    RowBox[{"n", ",", "numdim"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PM1", ",", "dqdt", ",", "dpdt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"newton", ",", "dqdtNewton", ",", "dpdtNewton"}], "}"}]}], 
    "}"}], "=", 
   RowBox[{"createPM1", "[", 
    RowBox[{"numdim", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qdotc", "=", 
   RowBox[{"CAssign", "[", 
    RowBox[{"dqdt", ",", "dqdt", ",", 
     RowBox[{"\"\<OptimizationSymbol\>\"", "\[Rule]", "o"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdotc", "=", 
   RowBox[{"CAssign", "[", 
    RowBox[{"dpdt", ",", "dpdt", ",", 
     RowBox[{"\"\<OptimizationSymbol\>\"", "\[Rule]", "o"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"CAssign", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dqdt", ",", "dpdt", ",", "PM1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dqdt", ",", "dpdt", ",", "PM1"}], "}"}], ",", 
     RowBox[{"\"\<OptimizationSymbol\>\"", "\[Rule]", "o"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationsNewton", "=", 
   RowBox[{"CAssign", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dqdtNewton", ",", "dpdtNewton", ",", "newton"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"dqdtNewton", ",", "dpdtNewton", ",", "newton"}], "}"}], ",", 
     RowBox[{"\"\<OptimizationSymbol\>\"", "->", "o"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<equations.txt\>\"", ",", "equations"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<newton_equations.txt\>\"", ",", "equationsNewton"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ndata.txt\>\"", ",", "ndata"}], "]"}]}], "Input",
 CellChangeTimes->{{3.824299615686453*^9, 3.8242996259770193`*^9}, {
   3.82429986550184*^9, 3.824299917045734*^9}, {3.82429995421813*^9, 
   3.824300042663149*^9}, {3.82430007270689*^9, 3.824300171080371*^9}, {
   3.824983732963091*^9, 3.824983746432678*^9}, {3.824983985160899*^9, 
   3.8249839980058613`*^9}, {3.8249843201416187`*^9, 3.824984329424213*^9}, {
   3.824984506801956*^9, 3.824984577957267*^9}, {3.835968246377914*^9, 
   3.835968308094911*^9}, {3.835968339217288*^9, 3.835968359454237*^9}, {
   3.83596844697736*^9, 3.835968455319734*^9}, {3.835969076757329*^9, 
   3.8359690779533243`*^9}, {3.835969126793948*^9, 3.835969126887323*^9}, {
   3.835969165648919*^9, 3.8359691658034983`*^9}, {3.8360569283878937`*^9, 
   3.83605692844495*^9}, {3.8360569666351624`*^9, 3.8360569699777613`*^9}, {
   3.836057593258383*^9, 3.8360575934033527`*^9}, {3.8363139122299347`*^9, 
   3.836313912320341*^9}, 3.836313984600707*^9, {3.840531339458028*^9, 
   3.840531358062192*^9}, {3.840531431531015*^9, 3.8405314743342037`*^9}, {
   3.840531577168167*^9, 3.840531593598803*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"355d4cf8-cccb-4f40-b4e3-6b8e2bfc3dde"],

Cell[BoxData["\<\"equations.txt\"\>"], "Output",
 CellChangeTimes->{3.840531136215869*^9, 3.840531364912633*^9, 
  3.840531480098198*^9, 3.840531598106634*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"f416c619-2630-4d2f-a9c1-68b568063ac5"],

Cell[BoxData["\<\"newton_equations.txt\"\>"], "Output",
 CellChangeTimes->{3.840531136215869*^9, 3.840531364912633*^9, 
  3.840531480098198*^9, 3.8405315981084557`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"ab6653e7-d5c8-456d-8fc3-3fe28309912a"],

Cell[BoxData["\<\"ndata.txt\"\>"], "Output",
 CellChangeTimes->{3.840531136215869*^9, 3.840531364912633*^9, 
  3.840531480098198*^9, 3.840531598110223*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"ad3b9ed4-0e25-4ba4-ab72-81c7beeb9b98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["equationsNewton"], "Input",
 CellChangeTimes->{{3.840532440363104*^9, 3.840532443731468*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"920c4801-bbfc-43d2-85e3-6fa11bab1b48"],

Cell[OutputFormData["\<\
\"o3=1/m1;\"
\"o7=1/m2;\"
\"o11=1/m3;\"
\"o15=-qx2;\"
\"o16=o15+qx1;\"
\"o27=-qx1;\"
\"o28=o27+qx2;\"
\"o39=-qx3;\"
\"o40=o39+qx1;\"
\"o51=o27+qx3;\"
\"o30=-qy1;\"
\"o33=-qz1;\"
\"o18=-qy2;\"
\"o19=o18+qy1;\"
\"o17=o16*o16;\"
\"o20=o19*o19;\"
\"o21=-qz2;\"
\"o22=o21+qz1;\"
\"o23=o22*o22;\"
\"o24=o17+o20+o23;\"
\"o25=pow(o24,-1.5);\"
\"o31=o30+qy2;\"
\"o29=o28*o28;\"
\"o32=o31*o31;\"
\"o34=o33+qz2;\"
\"o35=o34*o34;\"
\"o36=o29+o32+o35;\"
\"o37=pow(o36,-1.5);\"
\"o42=-qy3;\"
\"o43=o42+qy1;\"
\"o41=o40*o40;\"
\"o44=o43*o43;\"
\"o45=-qz3;\"
\"o46=o45+qz1;\"
\"o47=o46*o46;\"
\"o48=o41+o44+o47;\"
\"o49=pow(o48,-1.5);\"
\"o53=o30+qy3;\"
\"o52=o51*o51;\"
\"o54=o53*o53;\"
\"o55=o33+qz3;\"
\"o56=o55*o55;\"
\"o57=o52+o54+o56;\"
\"o58=pow(o57,-1.5);\"
\"o76=o39+qx2;\"
\"o85=o15+qx3;\"
\"o78=o42+qy2;\"
\"o77=o76*o76;\"
\"o79=o78*o78;\"
\"o80=o45+qz2;\"
\"o81=o80*o80;\"
\"o82=o77+o79+o81;\"
\"o83=pow(o82,-1.5);\"
\"o87=o18+qy3;\"
\"o86=o85*o85;\"
\"o88=o87*o87;\"
\"o89=o21+qz3;\"
\"o90=o89*o89;\"
\"o91=o86+o88+o90;\"
\"o92=pow(o91,-1.5);\"
\"dqdtNewton[0][0]=o3*px1;\"
\"dqdtNewton[0][1]=o3*py1;\"
\"dqdtNewton[0][2]=o3*pz1;\"
\"dqdtNewton[1][0]=o7*px2;\"
\"dqdtNewton[1][1]=o7*py2;\"
\"dqdtNewton[1][2]=o7*pz2;\"
\"dqdtNewton[2][0]=o11*px3;\"
\"dqdtNewton[2][1]=o11*py3;\"
\"dqdtNewton[2][2]=o11*pz3;\"
\"dpdtNewton[0][0]=0.5*G*(-(m1*m2*o16*o25)+m1*m2*o28*o37-m1*m3*o40*o49+m1*m3*\
o51*o58);\"
\"dpdtNewton[0][1]=0.5*G*(-(m1*m2*o19*o25)+m1*m2*o31*o37-m1*m3*o43*o49+m1*m3*\
o53*o58);\"
\"dpdtNewton[0][2]=0.5*G*(-(m1*m2*o22*o25)+m1*m2*o34*o37-m1*m3*o46*o49+m1*m3*\
o55*o58);\"
\"dpdtNewton[1][0]=0.5*G*(m1*m2*o16*o25-m1*m2*o28*o37-m2*m3*o76*o83+m2*m3*o85*\
o92);\"
\"dpdtNewton[1][1]=0.5*G*(m1*m2*o19*o25-m1*m2*o31*o37-m2*m3*o78*o83+m2*m3*o87*\
o92);\"
\"dpdtNewton[1][2]=0.5*G*(m1*m2*o22*o25-m1*m2*o34*o37-m2*m3*o80*o83+m2*m3*o89*\
o92);\"
\"dpdtNewton[2][0]=0.5*G*(m1*m3*o40*o49-m1*m3*o51*o58+m2*m3*o76*o83-m2*m3*o85*\
o92);\"
\"dpdtNewton[2][1]=0.5*G*(m1*m3*o43*o49-m1*m3*o53*o58+m2*m3*o78*o83-m2*m3*o87*\
o92);\"
\"dpdtNewton[2][2]=0.5*G*(m1*m3*o46*o49-m1*m3*o55*o58+m2*m3*o80*o83-m2*m3*o89*\
o92);\"
\"newton=0.5*(o3*(px1*px1+py1*py1+pz1*pz1)+o7*(px2*px2+py2*py2+pz2*pz2)+o11*(\
px3*px3+py3\\
\\\\\\n*py3+pz3*pz3))-0.5*G*((1.*m1*m2)/sqrt(o24)+(1.*m1*m2)/sqrt(o36)+(1.*m1*\
m3)/sqrt(o48\\
)+\\\\\\n(1.*m1*m3)/sqrt(o57)+(1.*m2*m3)/sqrt(o82)+(1.*m2*m3)/sqrt(o91));\"\
\>", "\<\
o3=1/m1;
o7=1/m2;
o11=1/m3;
o15=-qx2;
o16=o15+qx1;
o27=-qx1;
o28=o27+qx2;
o39=-qx3;
o40=o39+qx1;
o51=o27+qx3;
o30=-qy1;
o33=-qz1;
o18=-qy2;
o19=o18+qy1;
o17=o16*o16;
o20=o19*o19;
o21=-qz2;
o22=o21+qz1;
o23=o22*o22;
o24=o17+o20+o23;
o25=pow(o24,-1.5);
o31=o30+qy2;
o29=o28*o28;
o32=o31*o31;
o34=o33+qz2;
o35=o34*o34;
o36=o29+o32+o35;
o37=pow(o36,-1.5);
o42=-qy3;
o43=o42+qy1;
o41=o40*o40;
o44=o43*o43;
o45=-qz3;
o46=o45+qz1;
o47=o46*o46;
o48=o41+o44+o47;
o49=pow(o48,-1.5);
o53=o30+qy3;
o52=o51*o51;
o54=o53*o53;
o55=o33+qz3;
o56=o55*o55;
o57=o52+o54+o56;
o58=pow(o57,-1.5);
o76=o39+qx2;
o85=o15+qx3;
o78=o42+qy2;
o77=o76*o76;
o79=o78*o78;
o80=o45+qz2;
o81=o80*o80;
o82=o77+o79+o81;
o83=pow(o82,-1.5);
o87=o18+qy3;
o86=o85*o85;
o88=o87*o87;
o89=o21+qz3;
o90=o89*o89;
o91=o86+o88+o90;
o92=pow(o91,-1.5);
dqdtNewton[0][0]=o3*px1;
dqdtNewton[0][1]=o3*py1;
dqdtNewton[0][2]=o3*pz1;
dqdtNewton[1][0]=o7*px2;
dqdtNewton[1][1]=o7*py2;
dqdtNewton[1][2]=o7*pz2;
dqdtNewton[2][0]=o11*px3;
dqdtNewton[2][1]=o11*py3;
dqdtNewton[2][2]=o11*pz3;
dpdtNewton[0][0]=0.5*G*(-(m1*m2*o16*o25)+m1*m2*o28*o37-m1*m3*o40*o49+m1*m3*\
o51*o58);
dpdtNewton[0][1]=0.5*G*(-(m1*m2*o19*o25)+m1*m2*o31*o37-m1*m3*o43*o49+m1*m3*\
o53*o58);
dpdtNewton[0][2]=0.5*G*(-(m1*m2*o22*o25)+m1*m2*o34*o37-m1*m3*o46*o49+m1*m3*\
o55*o58);
dpdtNewton[1][0]=0.5*G*(m1*m2*o16*o25-m1*m2*o28*o37-m2*m3*o76*o83+m2*m3*o85*\
o92);
dpdtNewton[1][1]=0.5*G*(m1*m2*o19*o25-m1*m2*o31*o37-m2*m3*o78*o83+m2*m3*o87*\
o92);
dpdtNewton[1][2]=0.5*G*(m1*m2*o22*o25-m1*m2*o34*o37-m2*m3*o80*o83+m2*m3*o89*\
o92);
dpdtNewton[2][0]=0.5*G*(m1*m3*o40*o49-m1*m3*o51*o58+m2*m3*o76*o83-m2*m3*o85*\
o92);
dpdtNewton[2][1]=0.5*G*(m1*m3*o43*o49-m1*m3*o53*o58+m2*m3*o78*o83-m2*m3*o87*\
o92);
dpdtNewton[2][2]=0.5*G*(m1*m3*o46*o49-m1*m3*o55*o58+m2*m3*o80*o83-m2*m3*o89*\
o92);
newton=0.5*(o3*(px1*px1+py1*py1+pz1*pz1)+o7*(px2*px2+py2*py2+pz2*pz2)+o11*(\
px3*px3+py3\\
*py3+pz3*pz3))-0.5*G*((1.*m1*m2)/sqrt(o24)+(1.*m1*m2)/sqrt(o36)+(1.*m1*m3)/\
sqrt(o48)+\\
(1.*m1*m3)/sqrt(o57)+(1.*m2*m3)/sqrt(o82)+(1.*m2*m3)/sqrt(o91));\
\>"], "Output",
 CellChangeTimes->{3.840532445178398*^9},
 CellLabel->
  "Out[79]//OutputForm=",ExpressionUUID->"1610e044-9894-4c27-b360-\
1331abe31cd3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 747},
WindowMargins->{{Automatic, 13}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"3ff6c73d-1ec7-4b70-a4c0-31015437499f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 69, "Section",ExpressionUUID->"7361888e-6ca7-43b5-b428-e323aba84ced"],
Cell[CellGroupData[{
Cell[768, 29, 27034, 691, 2134, "Input",ExpressionUUID->"d47d1a9a-d987-449f-8141-2de1b6b60ac4"],
Cell[27805, 722, 335, 4, 41, "Output",ExpressionUUID->"5ac70fc3-4892-4f4d-9e5c-285a4f773cd1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28189, 732, 156, 3, 69, "Section",ExpressionUUID->"dde770ff-4d6f-4387-9558-a567e7e2526a"],
Cell[CellGroupData[{
Cell[28370, 739, 3451, 83, 273, "Input",ExpressionUUID->"355d4cf8-cccb-4f40-b4e3-6b8e2bfc3dde"],
Cell[31824, 824, 238, 3, 41, "Output",ExpressionUUID->"f416c619-2630-4d2f-a9c1-68b568063ac5"],
Cell[32065, 829, 247, 3, 41, "Output",ExpressionUUID->"ab6653e7-d5c8-456d-8fc3-3fe28309912a"],
Cell[32315, 834, 234, 3, 41, "Output",ExpressionUUID->"ad3b9ed4-0e25-4ba4-ab72-81c7beeb9b98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32586, 842, 186, 2, 41, "Input",ExpressionUUID->"920c4801-bbfc-43d2-85e3-6fa11bab1b48"],
Cell[32775, 846, 4602, 190, 922, "Output",ExpressionUUID->"1610e044-9894-4c27-b360-1331abe31cd3"]
}, Open  ]]
}, Open  ]]
}
]
*)

